import{i as Ce,j as Se,h as ee,b as Ie}from"./VTextField-6ef51958.js";import{b as _e,u as Me,c as Ae,a as Pe}from"./VSelect-05ba9522.js";import{E as ce,r as D,g as C,u as P,an as Le,aq as Y,ax as Ke,G as Re,H as De,ah as Oe,W as j,I as J,U as Te,A as X,x as te,a3 as Ee,K as je,a as c,F as H,m as z,k as le,aN as Be,d as Ne,aO as $e,aP as ae,O as ne,o as ue,c as Ue,i as ze,j as He,aJ as Qe,S as We,w as Ge,aK as Je,Q as oe,R as se,aL as Xe}from"./main-c1a030b6.js";import{f as Ye}from"./VOverlay-7afe38d6.js";import{c as Ze,V as qe,a as re}from"./VList-7bc83e08.js";import{m as et}from"./VImg-96e1ccfc.js";import{V as tt}from"./VMenu-e950e983.js";import{V as lt}from"./VChip-8fa0cf71.js";const at=(e,o,t)=>e==null||o==null?-1:e.toString().toLocaleLowerCase().indexOf(o.toString().toLocaleLowerCase()),nt=ce({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function ut(e,o,t){var F;const i=[],f=(t==null?void 0:t.default)??at,g=t!=null&&t.filterKeys?Y(t.filterKeys):!1,m=Object.keys((t==null?void 0:t.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return i;e:for(let h=0;h<e.length;h++){const[w,S=w]=Y(e[h]),r={},a={};let p=-1;if(o&&!(t!=null&&t.noFilter)){if(typeof w=="object"){const O=g||Object.keys(S);for(const _ of O){const B=Ke(S,_,S),T=(F=t==null?void 0:t.customKeyFilter)==null?void 0:F[_];if(p=T?T(B,o,w):f(B,o,w),p!==-1&&p!==!1)T?r[_]=p:a[_]=p;else if((t==null?void 0:t.filterMode)==="every")continue e}}else p=f(w,o,w),p!==-1&&p!==!1&&(a.title=p);const A=Object.keys(a).length,I=Object.keys(r).length;if(!A&&!I||(t==null?void 0:t.filterMode)==="union"&&I!==m&&!A||(t==null?void 0:t.filterMode)==="intersection"&&(I!==m||!A))continue}i.push({index:h,matches:{...a,...r}})}return i}function ot(e,o,t,i){const f=D([]),g=D(new Map),m=C(()=>i!=null&&i.transform?P(o).map(h=>[h,i.transform(h)]):P(o));Le(()=>{const h=typeof t=="function"?t():P(t),w=typeof h!="string"&&typeof h!="number"?"":String(h),S=ut(m.value,w,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),r=P(o),a=[],p=new Map;S.forEach(A=>{let{index:I,matches:O}=A;const _=r[I];a.push(_),p.set(_.value,O)}),f.value=a,g.value=p});function F(h){return g.value.get(h.value)}return{filteredItems:f,filteredMatches:g,getMatches:F}}function st(e,o,t){if(o==null)return e;if(Array.isArray(o))throw new Error("Multiple matches is not implemented");return typeof o=="number"&&~o?c(H,null,[c("span",{class:"v-autocomplete__unmask"},[e.substr(0,o)]),c("span",{class:"v-autocomplete__mask"},[e.substr(o,t)]),c("span",{class:"v-autocomplete__unmask"},[e.substr(o+t)])]):e}const rt=ce({autoSelectFirst:{type:[Boolean,String]},search:String,...nt({filterKeys:["title"]}),..._e(),...Re(Ce({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...et({transition:!1})},"VAutocomplete"),ct=De()({name:"VAutocomplete",props:rt(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,o){let{slots:t}=o;const{t:i}=Oe(),f=D(),g=j(!1),m=j(!0),F=j(!1),h=D(),w=D(),S=J(e,"menu"),r=C({get:()=>S.value,set:l=>{var n;S.value&&!l&&((n=h.value)!=null&&n.Î¨openChildren)||(S.value=l)}}),a=j(-1),p=C(()=>{var l;return(l=f.value)==null?void 0:l.color}),A=C(()=>r.value?e.closeText:e.openText),{items:I,transformIn:O,transformOut:_}=Ze(e),{textColorClasses:B,textColorStyles:T}=Te(p),y=J(e,"search",""),s=J(e,"modelValue",[],l=>O(l===null?[null]:Y(l)),l=>{const n=_(l);return e.multiple?n:n[0]??null}),K=Se(),{filteredItems:Q,getMatches:ie}=ot(e,I,()=>m.value?"":y.value),M=C(()=>e.hideSelected?Q.value.filter(l=>!s.value.some(n=>n.value===l.value)):Q.value),fe=C(()=>s.value.map(l=>l.props.value)),N=C(()=>{var n;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&y.value===((n=M.value[0])==null?void 0:n.title))&&M.value.length>0&&!m.value&&!F.value}),W=C(()=>e.hideNoData&&!I.value.length||e.readonly||(K==null?void 0:K.isReadonly.value)),G=D(),{onListScroll:ve,onListKeydown:de}=Me(G,f);function me(l){e.openOnClear&&(r.value=!0),y.value=""}function he(){W.value||(r.value=!0)}function ge(l){W.value||(g.value&&(l.preventDefault(),l.stopPropagation()),r.value=!r.value)}function ye(l){var R,u,k;if(e.readonly||K!=null&&K.isReadonly.value)return;const n=f.value.selectionStart,v=s.value.length;if((a.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(r.value=!0),["Escape"].includes(l.key)&&(r.value=!1),N.value&&["Enter","Tab"].includes(l.key)&&L(M.value[0]),l.key==="ArrowDown"&&N.value&&((R=G.value)==null||R.focus("next")),!!e.multiple){if(["Backspace","Delete"].includes(l.key)){if(a.value<0){l.key==="Backspace"&&!y.value&&(a.value=v-1);return}const d=a.value,x=s.value[a.value];x&&!x.props.disabled&&L(x),a.value=d>=v-1?v-2:d}if(l.key==="ArrowLeft"){if(a.value<0&&n>0)return;const d=a.value>-1?a.value-1:v-1;s.value[d]?a.value=d:(a.value=-1,f.value.setSelectionRange((u=y.value)==null?void 0:u.length,(k=y.value)==null?void 0:k.length))}if(l.key==="ArrowRight"){if(a.value<0)return;const d=a.value+1;s.value[d]?a.value=d:(a.value=-1,f.value.setSelectionRange(0,0))}}}function pe(l){y.value=l.target.value}function ke(l){if(ae(f.value,":autofill")||ae(f.value,":-webkit-autofill")){const n=I.value.find(v=>v.title===l.target.value);n&&L(n)}}function Ve(){var l;g.value&&(m.value=!0,(l=f.value)==null||l.focus())}function be(l){g.value=!0,setTimeout(()=>{F.value=!0})}function Fe(l){F.value=!1}function we(l){(l==null||l===""&&!e.multiple)&&(s.value=[])}const E=j(!1);function L(l){if(e.multiple){const n=s.value.findIndex(v=>e.valueComparator(v.value,l.value));if(n===-1)s.value=[...s.value,l];else{const v=[...s.value];v.splice(n,1),s.value=v}}else s.value=[l],E.value=!0,y.value=l.title,r.value=!1,m.value=!0,te(()=>E.value=!1)}return X(g,(l,n)=>{var v;l!==n&&(l?(E.value=!0,y.value=e.multiple?"":String(((v=s.value.at(-1))==null?void 0:v.props.title)??""),m.value=!0,te(()=>E.value=!1)):(!e.multiple&&!y.value?s.value=[]:N.value&&!F.value&&!s.value.some(R=>{let{value:u}=R;return u===M.value[0].value})&&L(M.value[0]),r.value=!1,y.value="",a.value=-1))}),X(y,l=>{!g.value||E.value||(l&&(r.value=!0),m.value=!l)}),X(r,()=>{if(!e.hideSelected&&r.value&&s.value.length){const l=M.value.findIndex(n=>s.value.some(v=>n.value===v.value));Ee&&window.requestAnimationFrame(()=>{var n;l>=0&&((n=w.value)==null||n.scrollToIndex(l))})}}),je(()=>{const l=!!(e.chips||t.chip),n=!!(!e.hideNoData||M.value.length||t["prepend-item"]||t["append-item"]||t["no-data"]),v=s.value.length>0,[R]=ee.filterProps(e);return c(ee,z({ref:f},R,{modelValue:y.value,"onUpdate:modelValue":we,focused:g.value,"onUpdate:focused":u=>g.value=u,validationValue:s.externalValue,counterValue:s.value.length,dirty:v,onInput:pe,onChange:ke,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":r.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!t.selection,"v-autocomplete--selecting-index":a.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:v?void 0:e.placeholder,"onClick:clear":me,"onMousedown:control":he,onKeydown:ye}),{...t,default:()=>c(H,null,[c(tt,z({ref:h,modelValue:r.value,"onUpdate:modelValue":u=>r.value=u,activator:"parent",contentClass:"v-autocomplete__content",disabled:W.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Ve},e.menuProps),{default:()=>[n&&c(qe,{ref:G,selected:fe.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onKeydown:de,onFocusin:be,onFocusout:Fe,onScrollPassive:ve,tabindex:"-1",color:e.itemColor??e.color},{default:()=>{var u,k,d;return[(u=t["prepend-item"])==null?void 0:u.call(t),!M.value.length&&!e.hideNoData&&(((k=t["no-data"])==null?void 0:k.call(t))??c(re,{title:i(e.noDataText)},null)),c(Ae,{ref:w,renderless:!0,items:M.value},{default:x=>{var q;let{item:V,index:b,itemRef:xe}=x;const Z=z(V.props,{ref:xe,key:b,active:N.value&&b===0?!0:void 0,onClick:()=>L(V)});return((q=t.item)==null?void 0:q.call(t,{item:V,index:b,props:Z}))??c(re,Z,{prepend:$=>{let{isSelected:U}=$;return c(H,null,[e.multiple&&!e.hideSelected?c(Pe,{key:V.value,modelValue:U,ripple:!1,tabindex:"-1"},null):void 0,V.props.prependIcon&&c(le,{icon:V.props.prependIcon},null)])},title:()=>{var $,U;return m.value?V.title:st(V.title,($=ie(V))==null?void 0:$.title,((U=y.value)==null?void 0:U.length)??0)}})}}),(d=t["append-item"])==null?void 0:d.call(t)]}})]}),s.value.map((u,k)=>{var V;function d(b){b.stopPropagation(),b.preventDefault(),L(u)}const x={"onClick:close":d,onMousedown(b){b.preventDefault(),b.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return c("div",{key:u.value,class:["v-autocomplete__selection",k===a.value&&["v-autocomplete__selection--selected",B.value]],style:k===a.value?T.value:{}},[l?t.chip?c(Be,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:u.title}}},{default:()=>{var b;return[(b=t.chip)==null?void 0:b.call(t,{item:u,index:k,props:x})]}}):c(lt,z({key:"chip",closable:e.closableChips,size:"small",text:u.title,disabled:u.props.disabled},x),null):((V=t.selection)==null?void 0:V.call(t,{item:u,index:k}))??c("span",{class:"v-autocomplete__selection-text"},[u.title,e.multiple&&k<s.value.length-1&&c("span",{class:"v-autocomplete__selection-comma"},[Ne(",")])])])})]),"append-inner":function(){var x;for(var u=arguments.length,k=new Array(u),d=0;d<u;d++)k[d]=arguments[d];return c(H,null,[(x=t["append-inner"])==null?void 0:x.call(t,...k),e.menuIcon?c(le,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:ge,onClick:$e,"aria-label":i(A.value),title:i(A.value)},null):void 0])}})}),Ye({isFocused:g,isPristine:m,menu:r,search:y,filteredItems:Q,select:L},f)}}),pt=Object.assign({name:"AppAutocomplete",inheritAttrs:!1},{__name:"AppAutocomplete",setup(e){const o=C(()=>{const i=ne(),f=i.id||i.label;return f?`app-autocomplete-${f}-${Math.random().toString(36).slice(2,7)}`:void 0}),t=C(()=>ne().label);return(i,f)=>(ue(),Ue("div",{class:Xe(["app-autocomplete flex-grow-1",i.$attrs.class])},[P(t)?(ue(),ze(Ie,{key:0,for:P(o),class:"mb-1 text-body-2 text-high-emphasis",text:P(t)},null,8,["for","text"])):He("",!0),c(ct,oe(se({...i.$attrs,class:null,label:void 0,id:P(o),variant:"outlined",menuProps:{contentClass:["app-inner-list","app-autocomplete__content","v-autocomplete__content"]}})),Qe({_:2},[We(i.$slots,(g,m)=>({name:m,fn:Ge(F=>[Je(i.$slots,m,oe(se(F||{})))])}))]),1040)],2))}});export{pt as _,nt as m,ot as u};
