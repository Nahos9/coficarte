import{_ as N}from"./AppAutocomplete-504a9932.js";import{_ as P}from"./AppSelect-f9ac71f0.js";import{_ as j}from"./AppTextField-b667de94.js";import{r as m,f as A,g as M,c as I,a as e,w as l,u as r,y as L,F as O,n as h,p as z,o as G,q as H,V as v,d as f,b as x,k as E,t as J,x as K}from"./main-f92e91a6.js";import{u as $}from"./useApi-328f604d.js";import{c as F}from"./createUrl-ccc62e1a.js";import{$ as Q}from"./api-98d9e2bb.js";import{V,a as n}from"./VRow-141a5c8a.js";import{V as W}from"./VSnackbar-9ceb4ab6.js";import{V as X}from"./VForm-3fbbbc13.js";import{V as Y}from"./VCard-7db182b5.js";import{V as Z}from"./VCardText-163c2c5d.js";import"./VTextField-e2c88c63.js";import"./VImg-3802a6ff.js";import"./VOverlay-3161847d.js";import"./VSelect-ec8e1407.js";import"./VList-89b70cfa.js";import"./VAvatar-22927773.js";import"./VDivider-5654b514.js";import"./dialog-transition-f344a9a7.js";import"./VMenu-372648e5.js";import"./VChip-45ccf804.js";import"./index-593e39a4.js";import"./useAbility-1191e859.js";const ee={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},ae={class:"d-flex gap-4 align-center flex-wrap"},Ae={__name:"[id]",async setup(re){let d,c;const R=h(),y=z();let q="/user";const k=()=>({name:"",email:"",password:"",profile:"",activated:"",password_change_required:"",agency_id:""}),i=m(k()),{data:S}=([d,c]=A(()=>$(F(`/user/${y.params.id}`,{query:{}}))),d=await d,c(),d),o=m(S.value.data.user),C=m(),T=()=>{var b;(b=C.value)==null||b.validate().then(async({valid:a})=>{if(a){const s=await Q(`/user/${y.params.id}`,{method:"PUT",body:{name:o.value.name,email:o.value.email,password:o.value.password,profile:o.value.profile,activated:o.value.activated,password_change_required:o.value.password_change_required,agency_id:o.value.agency_id}});if(i.value=k(),s.status==200)R.push(q);else{s.errors.name&&(i.value.name=s.errors.name[0],s.errors.name=null),s.errors.email&&(i.value.email=s.errors.email[0],s.errors.email=null),s.errors.password&&(i.value.password=s.errors.password[0],s.errors.password=null),s.errors.profile&&(i.value.profile=s.errors.profile[0],s.errors.profile=null),s.errors.activated&&(i.value.activated=s.errors.activated[0],s.errors.activated=null),s.errors.password_change_required&&(i.value.password_change_required=s.errors.password_change_required[0],s.errors.password_change_required=null),s.errors.agency_id&&(i.value.agency_id=s.errors.agency_id[0],s.errors.agency_id=null),w.value="";let u=!1;for(const p in s.errors)s.errors[p]!=null&&(U.value="error",s.errors[p].forEach(t=>{u=!0,w.value+=p+": "+t+"<br>"}));g.value=u}K(()=>{})}})},{data:B}=([d,c]=A(()=>$(F("/agency",{query:{paginate:"false"}}))),d=await d,c(),d),g=m(!1),w=m(""),U=m("success"),D=M(()=>B.value.data),_=m(!1);return(b,a)=>{const s=j,u=P,p=N;return G(),I(O,null,[e(V,null,{default:l(()=>[e(n,{cols:"12",md:"12"},{default:l(()=>[e(X,{ref_key:"refForm",ref:C,onSubmit:H(T,["prevent"])},{default:l(()=>[e(V,null,{default:l(()=>[e(n,{cols:"11"},{default:l(()=>[e(v,{"prepend-icon":"tabler-arrow-narrow-left",to:r(q)},{default:l(()=>a[9]||(a[9]=[f(" Utilisateurs ")])),_:1},8,["to"])]),_:1}),e(n,{cols:"1",class:"text-right"},{default:l(()=>[e(v,{"append-icon":"tabler-eye",to:{name:"user-id",params:{id:r(y).params.id}}},{default:l(()=>a[10]||(a[10]=[f(" Voir ")])),_:1},8,["to"])]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(n,{md:"12"},{default:l(()=>[e(Y,{class:"mb-6",title:"Modification du user de comité"},{default:l(()=>[e(Z,null,{default:l(()=>[e(V,null,{default:l(()=>[e(n,{cols:"12",md:"12",lg:"6"},{default:l(()=>[e(s,{modelValue:r(o).name,"onUpdate:modelValue":a[0]||(a[0]=t=>r(o).name=t),"error-messages":r(i).name,label:"Nom"},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",md:"12",lg:"6"},{default:l(()=>[e(s,{modelValue:r(o).email,"onUpdate:modelValue":a[1]||(a[1]=t=>r(o).email=t),"error-messages":r(i).email,type:"email",label:"Email"},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",md:"12",lg:"6"},{default:l(()=>[e(u,{modelValue:r(o).profile,"onUpdate:modelValue":a[2]||(a[2]=t=>r(o).profile=t),items:[{name:"Administrateur",id:"admin"},{name:"Chargé de clientèle",id:"responsible_for_customer"},{name:"Responsable marketing",id:"marketing_manager"},{name:"Chef d'agence",id:"agency_head"},{name:"Controlleur interne",id:"audit_controller"}],"error-messages":r(i).profile,label:"Profile","item-title":"name","item-value":"id",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",md:"12",lg:"6"},{default:l(()=>[e(p,{modelValue:r(o).agency_id,"onUpdate:modelValue":a[3]||(a[3]=t=>r(o).agency_id=t),items:r(D),"error-messages":r(i).agency_id,label:"Agency","item-title":"name","item-value":"id",required:""},null,8,["modelValue","items","error-messages"])]),_:1}),e(n,{cols:"12",md:"12",lg:"6"},{default:l(()=>[e(u,{modelValue:r(o).activated,"onUpdate:modelValue":a[4]||(a[4]=t=>r(o).activated=t),items:[{name:"Activé",id:!0},{name:"Désactivé",id:!1}],"error-messages":r(i).activated,label:"Activation","item-title":"name","item-value":"id",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",md:"12",lg:"6"},{default:l(()=>[e(u,{modelValue:r(o).password_change_required,"onUpdate:modelValue":a[5]||(a[5]=t=>r(o).password_change_required=t),items:[{name:"Obligatoire",id:!0},{name:"Facultatif",id:!1}],"error-messages":r(i).password_change_required,label:"Changement de mot de passe","item-title":"name","item-value":"id",required:""},null,8,["modelValue","error-messages"])]),_:1}),e(n,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(s,{modelValue:r(o).password,"onUpdate:modelValue":a[6]||(a[6]=t=>r(o).password=t),label:"Password",placeholder:"············",type:r(_)?"text":"password","error-messages":r(i).password,"append-inner-icon":r(_)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[7]||(a[7]=t=>_.value=!r(_)),class:"mb-8"},null,8,["modelValue","type","error-messages","append-inner-icon"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(n,{cols:"12"},{default:l(()=>[x("div",ee,[a[13]||(a[13]=x("div",{class:"d-flex flex-column justify-center"},null,-1)),x("div",ae,[e(v,{type:"reset",variant:"tonal",color:"primary"},{default:l(()=>[e(E,{start:"",icon:"tabler-circle-minus"}),a[11]||(a[11]=f(" Effacer "))]),_:1}),e(v,{type:"submit",class:"me-3"},{default:l(()=>[a[12]||(a[12]=f(" Enregistrer ")),e(E,{end:"",icon:"tabler-checkbox"})]),_:1})])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),e(W,{modelValue:r(g),"onUpdate:modelValue":a[8]||(a[8]=t=>L(g)?g.value=t:null),transition:"scale-transition",location:"top end",color:r(U)},{default:l(()=>[f(J(r(w)),1)]),_:1},8,["modelValue","color"])],64)}}};export{Ae as default};
