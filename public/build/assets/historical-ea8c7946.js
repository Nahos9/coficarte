import{_ as ie}from"./AppTextarea-7e0e2f52.js";import{V as de,p as ue,a as me,_ as ce}from"./VPagination-52c4272c.js";import{_ as pe}from"./AppTextField-5188a555.js";import{_ as fe}from"./AppAutocomplete-af35b729.js";import"./api-f2619c07.js";import{_ as ve}from"./AppSelect-0261496b.js";import{r as s,e as _e,f as N,g as w,c as Ve,a as t,w as o,u as l,y as i,h as ge,o as U,b as u,V as p,d as r,i as P,j as A,k as f,t as v,m as h}from"./main-463077af.js";import{u as E}from"./useApi-3f1d0661.js";import{c as M}from"./createUrl-c75b8deb.js";import{_ as be}from"./_plugin-vue_export-helper-c27b6911.js";import{V as I}from"./VCard-f37805c9.js";import{V as xe}from"./VDialog-4ca17bc7.js";import{V as ye}from"./VSnackbar-9493ecb7.js";import{V as _}from"./VCardText-f2d6cd94.js";import{V as q,a as R}from"./VRow-7bef6683.js";import{V as S}from"./VDivider-920c0dd6.js";import{V as ke}from"./VSpacer-97684b93.js";import{V as Ce}from"./VChip-5df8d3ea.js";import{V as we}from"./VTooltip-d3405e64.js";import"./VTextField-5f329365.js";import"./VImg-85115af3.js";import"./VOverlay-5e671133.js";import"./VSelect-fb294b03.js";import"./VList-36243e5d.js";import"./VAvatar-b69f6ba7.js";import"./dialog-transition-11e18e92.js";import"./VMenu-3d9da805.js";import"./index-593e39a4.js";import"./useAbility-c6021948.js";const Ue={class:"d-flex flex-wrap gap-4 mx-5"},$e={class:"d-flex align-center"},Te={class:"d-flex gap-4 flex-wrap align-center"},De={class:"custom-loader"},Pe={class:"text-center"},Ae={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},Ie={class:"text-sm text-medium-emphasis mb-0"},Re={__name:"historical",async setup(Se){let m,V;const g=s(""),b=s([]),x=s(8),d=s(1),z=s(0),c=s(!1),O=s(""),Q=s("");s("");const G=s(""),H=s(),$=s("cancel"),J=s(!1),K=_e("userData").value,y=s(null),k=s(null),C=s(null),W=[{title:"Initiateur",key:"sender.name"},{title:"Receptioniste",key:"receiver.name"},{title:"Nbre carte",key:"nbr_carte_in_transfert"},{title:"Commentaire",key:"comment"},{title:"Date de transfert",key:"created_at_fr"},{title:"Statut",key:"status_fr"},{title:"Actions",key:"actions",sortable:!1}],{data:T,execute:X}=([m,V]=N(()=>E(M("/transfer",{query:{search:g,page:d,with_sender:"true",with_receiver:"true",multi_status:"r-c-v",status:C,sender_id:y,receiver_id:k}}))),m=await m,V(),m),{data:Y,execute:Be}=([m,V]=N(()=>E(M("/user",{query:{paginate:"false",multi_profile:{marketing_manager:"rc-ah-mm",agency_head:"rc-mm-ah",responsible_for_customer:"ah-rc"}[K.role]}}))),m=await m,V(),m),Z=n=>{b.value[n]=!0,setTimeout(()=>{b.value[n]=!1},1e3)},ee=n=>{d.value=n.page},te=w(()=>T.value.data),B=w(()=>T.value.total),j=w(()=>T.value.last_page),D=s(!1),ae=s(""),le=s("success"),F=w(()=>Y.value.data);return(n,e)=>{const L=fe,oe=pe,se=ge("IconBtn"),re=ce,ne=ie;return U(),Ve("div",null,[t(I,{class:"mb-6"},{default:o(()=>[t(_,null,{default:o(()=>[t(q,null,{default:o(()=>[t(_,null,{default:o(()=>e[14]||(e[14]=[u("h2",null," Liste des transferts ",-1)])),_:1})]),_:1})]),_:1})]),_:1}),t(I,{title:"Filtres",class:"mb-6"},{default:o(()=>[t(_,null,{default:o(()=>[t(q,null,{default:o(()=>[t(R,{cols:"12",sm:"4"},{default:o(()=>[t(L,{modelValue:l(y),"onUpdate:modelValue":e[0]||(e[0]=a=>i(y)?y.value=a:null),placeholder:"Initiateur","item-title":"name","item-value":"id",items:l(F),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),t(R,{cols:"12",sm:"4"},{default:o(()=>[t(L,{modelValue:l(k),"onUpdate:modelValue":e[1]||(e[1]=a=>i(k)?k.value=a:null),placeholder:"Receptionniste","item-title":"name","item-value":"id",items:l(F),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),t(R,{cols:"12",sm:"4"},{default:o(()=>[t(ve,{modelValue:l(C),"onUpdate:modelValue":e[2]||(e[2]=a=>i(C)?C.value=a:null),placeholder:"Statut",items:[{value:"canceled",title:"Annulé"},{value:"rejected",title:"Rejeté"},{value:"validated",title:"Validé"}],clearable:"","clear-icon":"tabler-x"},null,8,["modelValue"])]),_:1})]),_:1}),t(S,{class:"my-4"})]),_:1}),u("div",Ue,[u("div",$e,[t(oe,{modelValue:l(g),"onUpdate:modelValue":e[3]||(e[3]=a=>i(g)?g.value=a:null),placeholder:"Rechercher un transfer",density:"compact",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),t(ke),u("div",Te,[t(p,{variant:"tonal",color:"secondary","prepend-icon":"tabler-upload"},{default:o(()=>e[15]||(e[15]=[r(" Export ")])),_:1}),n.$can("create","transfer")?(U(),P(p,{key:0,color:"primary","prepend-icon":"tabler-plus",to:{name:"transfer-add"}},{default:o(()=>e[16]||(e[16]=[r(" Nouveau ")])),_:1})):A("",!0),t(p,{loading:l(b)[3],disabled:l(b)[3],"prepend-icon":"tabler-refresh",onClick:e[4]||(e[4]=a=>{l(X)(),Z(3)})},{loader:o(()=>[u("span",De,[t(f,{icon:"tabler-refresh"})])]),default:o(()=>[e[17]||(e[17]=r(" Recharger "))]),_:1},8,["loading","disabled"])])]),t(S,{class:"mt-4"}),t(l(de),{"items-per-page":l(x),"onUpdate:itemsPerPage":e[6]||(e[6]=a=>i(x)?x.value=a:null),page:l(d),"onUpdate:page":e[7]||(e[7]=a=>i(d)?d.value=a:null),headers:W,items:l(te),"items-length":l(B),class:"text-no-wrap","onUpdate:options":ee},{"item.status_fr":o(({item:a})=>[t(Ce,{class:"ma-2",color:{canceled:"secondary",rejected:"error",validated:"success"}[a.status],label:""},{default:o(()=>[t(f,{icon:{canceled:"tabler-x",rejected:"tabler-x",validated:"tabler-check"}[a.status],start:""},null,8,["icon"]),r(" "+v(a.status_fr),1)]),_:2},1032,["color"])]),"item.actions":o(({item:a})=>[u("div",Pe,[u("div",null,[n.$can("read","transfer")||n.$can("historical","transfer")||n.$can("update","transfer")?(U(),P(se,{key:0,to:{name:"transfer-id",params:{id:a.id}}},{default:o(()=>[t(we,{activator:"parent",transition:"scroll-x-transition",location:"start"},{default:o(()=>e[18]||(e[18]=[r("Details ")])),_:1}),t(f,{icon:" tabler-eye"})]),_:2},1032,["to"])):A("",!0)])])]),bottom:o(()=>[t(S),u("div",Ae,[u("p",Ie,v(l(ue)({page:l(d),itemsPerPage:l(x)},l(B))),1),t(me,{modelValue:l(d),"onUpdate:modelValue":e[5]||(e[5]=a=>i(d)?d.value=a:null),length:l(j),"total-visible":n.$vuetify.display.xs?1:Math.min(l(j),5)},{prev:o(a=>[t(p,h({variant:"tonal",color:"default"},a,{icon:!1}),{default:o(()=>[t(f,{start:"",icon:"tabler-arrow-left"}),e[19]||(e[19]=r(" Précedent "))]),_:2},1040)]),next:o(a=>[t(p,h({variant:"tonal",color:"default"},a,{icon:!1}),{default:o(()=>[e[20]||(e[20]=r(" Suivant ")),t(f,{end:"",icon:"tabler-arrow-right"})]),_:2},1040)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),t(xe,{modelValue:l(c),"onUpdate:modelValue":e[12]||(e[12]=a=>i(c)?c.value=a:null),class:"v-dialog-sm"},{default:o(()=>[t(re,{onClick:e[8]||(e[8]=a=>c.value=!l(c))}),t(I,{title:l(O)},{default:o(()=>[t(_,null,{default:o(()=>[r(v(l(Q))+" ",1),l(J)?(U(),P(ne,{key:0,class:"mt-3",modelValue:l($),"onUpdate:modelValue":e[9]||(e[9]=a=>i($)?$.value=a:null),label:"Commentaire",placeholder:"Ex: RAS"},null,8,["modelValue"])):A("",!0)]),_:1}),t(_,{class:"d-flex justify-end gap-3 flex-wrap"},{default:o(()=>[t(p,{color:"secondary",variant:"tonal",onClick:e[10]||(e[10]=a=>c.value=!1)},{default:o(()=>e[21]||(e[21]=[r(" Retour ")])),_:1}),t(p,{onClick:e[11]||(e[11]=a=>{l(H)(l(z)),c.value=!1})},{default:o(()=>[r(v(l(G)),1)]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]),t(ye,{modelValue:l(D),"onUpdate:modelValue":e[13]||(e[13]=a=>i(D)?D.value=a:null),transition:"scale-transition",location:"top end",color:l(le)},{default:o(()=>[r(v(l(ae)),1)]),_:1},8,["modelValue","color"])])}}},ut=be(Re,[["__scopeId","data-v-f2e5a152"]]);export{ut as default};
