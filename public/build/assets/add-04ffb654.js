import{r as b}from"./validators-be8c4c00.js";import{D as M,E as J,G,H,I as K,g as T,J as O,K as z,a as e,n as j,r as y,e as Q,f as F,c as W,b as c,w as l,s as X,p as Y,v as Z,o as ee,u as p,x as ae,V as E,d as w,l as S,t as te,y as le}from"./main-6c5357b5.js";import{_ as re}from"./AppDateTimePicker-e03c24d6.js";import{_ as oe}from"./AppTextField-d3945dd9.js";import{m as se,V as $,_ as ue}from"./AppAutocomplete-da2ee21a.js";import{_ as de}from"./AppSelect-eb5d54d3.js";import{$ as ne}from"./api-606af7a9.js";import{u as B}from"./useApi-83881d3c.js";import{c as N}from"./createUrl-93691d1d.js";import{_ as ie}from"./_plugin-vue_export-helper-c27b6911.js";import{V as me}from"./VForm-88f4e97a.js";import{V as ce}from"./VSnackbar-06b63ae1.js";import{V as P,a as d}from"./VRow-8103f026.js";import{V as pe}from"./VCard-dc87bf31.js";import{V as _e}from"./VCardText-e8274b7b.js";import{m as fe,u as ve,V as R}from"./VInput-1661bdca.js";import"./VTextField-2fd207a8.js";import"./VImg-9d008c95.js";import"./VOverlay-cd754bf3.js";import"./easing-9f15041e.js";import"./VList-d87f67dd.js";import"./VAvatar-de22e4a2.js";import"./VDivider-7b29517b.js";import"./dialog-transition-7556fd62.js";import"./VMenu-64afd89b.js";import"./VChip-383f7682.js";import"./index-593e39a4.js";import"./useAbility-0154d632.js";const Ve=M({...fe(),...J(se(),["inline"])},"VCheckbox"),be=G()({name:"VCheckbox",inheritAttrs:!1,props:Ve(),emits:{"update:modelValue":n=>!0,"update:focused":n=>!0},setup(n,i){let{attrs:v,slots:x}=i;const a=H(n,"modelValue"),{isFocused:k,focus:u,blur:g}=ve(n),h=K(),q=T(()=>n.id||`checkbox-${h}`);return O(()=>{const[U,D]=z(v),[A,I]=R.filterProps(n),[V,C]=$.filterProps(n);return e(R,j({class:["v-checkbox",n.class]},U,A,{modelValue:a.value,"onUpdate:modelValue":_=>a.value=_,id:q.value,focused:k.value,style:n.style}),{...x,default:_=>{let{id:o,messagesId:t,isDisabled:m,isReadonly:s}=_;return e($,j(V,{id:o.value,"aria-describedby":t.value,disabled:m.value,readonly:s.value},D,{modelValue:a.value,"onUpdate:modelValue":f=>a.value=f,onFocus:u,onBlur:g}),x)}})}),{}}});const ye={class:"d-flex align-center justify-center pa-2"},ge={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},xe={class:"d-flex flex-column justify-center"},ke={class:"d-flex gap-4 align-center flex-wrap"},Ce={__name:"add",async setup(n){let i,v;const x=Y(),a=y({sale_date:null,credit_card_id:null,number_id:"8456",customer_type:null,customer_name:null,account_number:null,account_type_id:null,customer_phone_number:null,is_dotation:!1}),k=()=>({sale_date:"",credit_card_id:"",number_id:"",customer_type:"",customer_name:"",account_number:"",account_type_id:"",customer_phone_number:"",is_dotation:""}),u=y(k()),g=y(),h=()=>{var o;(o=g.value)==null||o.validate().then(async({valid:t})=>{if(t){const m=await ne("/sale",{method:"POST",body:{sale_date:a.value.sale_date,credit_card_id:a.value.credit_card_id,number_id:a.value.number_id,customer_type:a.value.customer_type,customer_name:a.value.customer_name,account_number:a.value.account_number,account_type_id:a.value.account_type_id,customer_phone_number:a.value.customer_phone_number,is_dotation:a.value.is_dotation}});if(u.value=k(),m.status==201)_.value="success",V.value=!0,x.push("/sale");else{_.value="error",V.value=!0,C.value="";for(const s in m.errors)m.errors[s].forEach(f=>{console.log(s+": "+f),u.value[s]+=f+`
`,C.value+=s+": "+f+", "})}le(()=>{var s;(s=g.value)==null||s.resetValidation()})}})},q=Q("userData").value,{data:U}=([i,v]=F(()=>B(N("/credit-card",{query:{possessor_id:q.id,status:"owned",paginate:"false"}}))),i=await i,v(),i),D=T(()=>U.value.data),{data:A}=([i,v]=F(()=>B(N("/account-type",{query:{paginate:"false"}}))),i=await i,v(),i),I=T(()=>A.value.data),V=y(!1),C=y(""),_=y("success");return(o,t)=>{const m=ue,s=oe,f=re,L=Z("mask");return ee(),W("div",null,[t[13]||(t[13]=c("div",{class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},[c("div",{class:"d-flex flex-column justify-center"},[c("h4",{class:"text-h4 font-weight-medium"},"Ajouter des cartes"),c("span",null,"Informations sur la première cartes du lot")])],-1)),e(me,{ref_key:"refForm",ref:g,onSubmit:X(h,["prevent"])},{default:l(()=>[e(P,null,{default:l(()=>[e(d,{md:"12"},{default:l(()=>[e(pe,{class:"mb-6",title:"Information des cartes"},{default:l(()=>[e(_e,null,{default:l(()=>[e(P,null,{default:l(()=>[e(d,{cols:"12",md:"12",lg:"9"},{default:l(()=>[e(P,null,{default:l(()=>[e(d,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(m,{modelValue:a.value.credit_card_id,"onUpdate:modelValue":t[0]||(t[0]=r=>a.value.credit_card_id=r),items:p(D),"error-messages":u.value.credit_card_id,label:"Carte vendu","item-title":"card_number_fr","item-value":"id",rules:["requiredValidator"in o?o.requiredValidator:p(b)]},null,8,["modelValue","items","error-messages","rules"])]),_:1}),e(d,{cols:"12",md:"12",lg:"12"},{default:l(()=>[ae(e(s,{modelValue:a.value.number_id,"onUpdate:modelValue":t[1]||(t[1]=r=>a.value.number_id=r),"error-messages":u.value.number_id,label:"4 Derniers chiffres du numéro de la carte",placeholder:"Ex: 2595",rules:["requiredValidator"in o?o.requiredValidator:p(b)]},null,8,["modelValue","error-messages","rules"]),[[L,"####"]])]),_:1}),e(d,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(de,{modelValue:a.value.customer_type,"onUpdate:modelValue":t[2]||(t[2]=r=>a.value.customer_type=r),items:[{title:"Entreprise",value:"business"},{title:"Particulier",value:"particular"}],"error-messages":u.value.customer_type,label:"Type de l'acheteur",rules:["requiredValidator"in o?o.requiredValidator:p(b)]},null,8,["modelValue","error-messages","rules"])]),_:1}),e(d,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(s,{modelValue:a.value.customer_name,"onUpdate:modelValue":t[3]||(t[3]=r=>a.value.customer_name=r),"error-messages":u.value.customer_name,label:"Nom du client",placeholder:"Ex: John",rules:["requiredValidator"in o?o.requiredValidator:p(b)]},null,8,["modelValue","error-messages","rules"])]),_:1}),e(d,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(s,{modelValue:a.value.account_number,"onUpdate:modelValue":t[4]||(t[4]=r=>a.value.account_number=r),type:"number","error-messages":u.value.account_number,label:"Numéro de compte du client",placeholder:"Ex: 371360000786"},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(s,{modelValue:a.value.customer_phone_number,"onUpdate:modelValue":t[5]||(t[5]=r=>a.value.customer_phone_number=r),"error-messages":u.value.customer_phone_number,label:"Numéro de téléphone du client",placeholder:"Ex: +241 77 56 76 00"},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(be,{modelValue:a.value.is_dotation,"onUpdate:modelValue":t[6]||(t[6]=r=>a.value.is_dotation=r),"error-messages":u.value.is_dotation,label:"Dotation"},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(m,{modelValue:a.value.account_type_id,"onUpdate:modelValue":t[7]||(t[7]=r=>a.value.account_type_id=r),items:p(I),"error-messages":u.value.account_type_id,label:"Type de compte","item-title":"name","item-value":"id",rules:["requiredValidator"in o?o.requiredValidator:p(b)]},null,8,["modelValue","items","error-messages","rules"])]),_:1})]),_:1})]),_:1}),e(d,{cols:"12",md:"12",lg:"3"},{default:l(()=>[c("div",ye,[e(f,{modelValue:a.value.sale_date,"onUpdate:modelValue":t[8]||(t[8]=r=>a.value.sale_date=r),"error-messages":u.value.sale_date,label:"Date de la vente",rules:["requiredValidator"in o?o.requiredValidator:p(b)],config:{inline:!0},class:"calendar-date-picker"},null,8,["modelValue","error-messages","rules"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12"},{default:l(()=>[c("div",ge,[c("div",xe,[e(d,{cols:"11"},{default:l(()=>[e(E,{"prepend-icon":"tabler-arrow-narrow-left",to:"/sale"},{default:l(()=>t[10]||(t[10]=[w(" ventes ")])),_:1})]),_:1})]),c("div",ke,[e(E,{type:"reset",variant:"tonal",color:"primary"},{default:l(()=>[e(S,{start:"",icon:"tabler-circle-minus"}),t[11]||(t[11]=w(" Effacer "))]),_:1}),e(E,{type:"submit",class:"me-3"},{default:l(()=>[t[12]||(t[12]=w(" Enregistrer ")),e(S,{end:"",icon:"tabler-checkbox"})]),_:1})])])]),_:1})]),_:1})]),_:1},512),e(ce,{modelValue:V.value,"onUpdate:modelValue":t[9]||(t[9]=r=>V.value=r),transition:"scale-transition",location:"top end",color:_.value},{default:l(()=>[w(te(C.value),1)]),_:1},8,["modelValue","color"])])}}},Ye=ie(Ce,[["__scopeId","data-v-58bdff15"]]);export{Ye as default};
