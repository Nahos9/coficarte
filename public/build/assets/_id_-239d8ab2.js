import{r as c}from"./validators-be8c4c00.js";import{r as u,f as S,c as T,a as e,w as l,u as r,y as $,F as j,n as A,p as B,s as N,o as M,q as P,V as g,d as p,v as G,b as f,k as D,t as I,x as z}from"./main-ab682c06.js";import{_ as H}from"./AppDateTimePicker-e160c764.js";import{_ as J}from"./AppTextField-9a0d8e0e.js";import{u as K}from"./useApi-359dfef2.js";import{c as L}from"./createUrl-0640aad8.js";import{$ as O}from"./api-b60cb23e.js";import{V as _,a as i}from"./VRow-a90cbb86.js";import{V as Q}from"./VSnackbar-3d97ef73.js";import{V as W}from"./VForm-c95c9467.js";import{V as X}from"./VCard-1d94407e.js";import{V as Y}from"./VCardText-6a556de3.js";import"./VTextField-654b64b0.js";import"./VImg-d7e66a8a.js";import"./VOverlay-607de400.js";import"./index-593e39a4.js";import"./useAbility-6a37d43c.js";import"./VAvatar-7f2408c8.js";const Z={class:"d-flex align-center justify-center pa-2"},h={class:"d-flex align-center justify-center pa-2"},ee={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},re={class:"d-flex gap-4 align-center flex-wrap"},xe={__name:"[id]",async setup(ae){let V,k;const U=A(),y=B();let q="/credit-card";const w=()=>({card_number:"",delivery_date:"",expiration_date:"",invoice_reference:"",price:""}),d=u(w()),{data:R}=([V,k]=S(()=>K(L(`/credit-card/${y.params.id}`,{query:{}}))),V=await V,k(),V);var t=u(R.value.data.creditCard);const E=u(),F=()=>{var o;(o=E.value)==null||o.validate().then(async({valid:a})=>{if(a){const n=await O(`/credit-card/${y.params.id}`,{method:"PUT",body:{card_number:t.value.card_number.replace(/\s+/g,""),delivery_date:t.value.delivery_date,expiration_date:t.value.expiration_date,invoice_reference:t.value.invoice_reference,price:t.value.price}});if(d.value=w(),n.status==200)U.push(q);else{v.value=!0,C.value="error",x.value="";for(const m in n.errors)n.errors[m].forEach(b=>{x.value+=b+`
`,d.value[m]+=b+`
`})}z(()=>{})}})},v=u(!1),x=u(""),C=u("success");return(o,a)=>{const n=J,m=H,b=N("mask");return M(),T(j,null,[e(_,null,{default:l(()=>[e(i,{cols:"12",md:"12"},{default:l(()=>[e(W,{ref_key:"refForm",ref:E,onSubmit:P(F,["prevent"])},{default:l(()=>[e(_,null,{default:l(()=>[e(i,{cols:"11"},{default:l(()=>[e(g,{"prepend-icon":"tabler-arrow-narrow-left",to:r(q)},{default:l(()=>a[6]||(a[6]=[p(" Coficartes ")])),_:1},8,["to"])]),_:1}),e(i,{cols:"1",class:"text-right"},{default:l(()=>[e(g,{"append-icon":"tabler-eye",to:{name:"credit-card-id",params:{id:r(y).params.id}}},{default:l(()=>a[7]||(a[7]=[p(" Voir ")])),_:1},8,["to"])]),_:1})]),_:1}),e(_,null,{default:l(()=>[e(i,{md:"12"},{default:l(()=>[e(X,{class:"mb-6",title:"Modification du credit-card de comité"},{default:l(()=>[e(Y,null,{default:l(()=>[e(_,null,{default:l(()=>[e(i,{cols:"12"},{default:l(()=>[e(_,null,{default:l(()=>[e(i,{cols:"12",md:"12",lg:"12"},{default:l(()=>[G(e(n,{modelValue:r(t).card_number,"onUpdate:modelValue":a[0]||(a[0]=s=>r(t).card_number=s),"error-messages":r(d).card_number,label:"Numéro de la carte",placeholder:"Ex: 00 12 52 25 95",rules:["requiredValidator"in o?o.requiredValidator:r(c)]},null,8,["modelValue","error-messages","rules"]),[[b,"## ## ## ## ##"]])]),_:1}),e(i,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(n,{modelValue:r(t).invoice_reference,"onUpdate:modelValue":a[1]||(a[1]=s=>r(t).invoice_reference=s),"error-messages":r(d).invoice_reference,label:"Référence de la facture",placeholder:"Ex: DD5DDG425",rules:["requiredValidator"in o?o.requiredValidator:r(c)]},null,8,["modelValue","error-messages","rules"])]),_:1}),e(i,{cols:"12",md:"12",lg:"12"},{default:l(()=>[e(n,{modelValue:r(t).price,"onUpdate:modelValue":a[2]||(a[2]=s=>r(t).price=s),type:"number","error-messages":r(d).price,label:"Prix de vente",placeholder:"Ex: 5000",rules:["requiredValidator"in o?o.requiredValidator:r(c)]},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1})]),_:1}),e(i,{cols:"6"},{default:l(()=>[f("div",Z,[e(m,{modelValue:r(t).delivery_date,"onUpdate:modelValue":a[3]||(a[3]=s=>r(t).delivery_date=s),"error-messages":r(d).delivery_date,label:"Date de livraison",placeholder:"Ex: 2022-01-01",rules:["requiredValidator"in o?o.requiredValidator:r(c)],config:{inline:!0},class:"calendar-date-picker"},null,8,["modelValue","error-messages","rules"])])]),_:1}),e(i,{cols:"6"},{default:l(()=>[f("div",h,[e(m,{modelValue:r(t).expiration_date,"onUpdate:modelValue":a[4]||(a[4]=s=>r(t).expiration_date=s),"error-messages":r(d).expiration_date,label:"Date d'expiration",placeholder:"Ex: 2022-01-01",rules:["requiredValidator"in o?o.requiredValidator:r(c)],config:{inline:!0},class:"calendar-date-picker"},null,8,["modelValue","error-messages","rules"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(i,{cols:"12"},{default:l(()=>[f("div",ee,[a[10]||(a[10]=f("div",{class:"d-flex flex-column justify-center"},null,-1)),f("div",re,[e(g,{type:"reset",variant:"tonal",color:"primary"},{default:l(()=>[e(D,{start:"",icon:"tabler-circle-minus"}),a[8]||(a[8]=p(" Effacer "))]),_:1}),e(g,{type:"submit",class:"me-3"},{default:l(()=>[a[9]||(a[9]=p(" Enregistrer ")),e(D,{end:"",icon:"tabler-checkbox"})]),_:1})])])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}),e(Q,{modelValue:r(v),"onUpdate:modelValue":a[5]||(a[5]=s=>$(v)?v.value=s:null),transition:"scale-transition",location:"top end",color:r(C)},{default:l(()=>[p(I(r(x)),1)]),_:1},8,["modelValue","color"])],64)}}};export{xe as default};
